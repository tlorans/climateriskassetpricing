\chapter{ESG Risk Premium}

\section{ESG Risk}


\subsection{Expected Utility}

Let's assume a single period model, from $t=0$ to $t=1$.
We have $N$ stocks. 

The investor $i$ has an exponential CARA utility function, with 
$\tilde{W}_{1,i}$ the wealth at period 1, and $X_i$ the
$N \times 1$ vector of portfolio weights.

\begin{equation}
    V(\tilde{W}_{1,i}, X_i) = -\exp{(-A_i \tilde{W}_{1,i}-b_i^T X_i)}
\end{equation}

with $A_i$ agent's absolute risk aversion, $b_i$ an $N \times 1$ vector of nonpecuniary 
benefits. 

\begin{equation}
    b_i = d_i g 
\end{equation}

with $g$ an $N \times 1$ vector and $d_i \geq 0$ a scalar measuring 
the agent's taste for the nonpecuniary benefits.


The expectation of agent $i$'s in period 0 are:

\begin{equation}
    E_0(V(\tilde{W}_{1,i}, X_i)) = E_0(-\exp{(-A_i \tilde{W}_{1,i}-b_i^T X_i)})
\end{equation}

We can replace $\tilde{W}_{1,i}$ by the relation 
$\tilde{W}_{1,i} = W_{0,i}(1 + r_f + X_i^T \tilde{r}_1)$
 and define $a_i := A_i W_{0,i}$. The idea is to make out from the
expectation the terms that we know about (in period 0), and reexpress 
the terms within the expectation as a function of the
portfolio weights $X_i$. The last two steps use the fact that 
$\tilde{r}_1 \sim N(\mu, \Sigma)$.

\begin{equation}
    \begin{aligned}
    E_0(V(\tilde{W}_{1,i}, X_i)) = E_0(-\exp{(-A_i W_{0,i}(1 + r_f + X_i^T \tilde{r}_1)-b_i^T X_i)}) \\
    = E_0(-\exp{(-a_i(1 + r_f + X_i^T \tilde{r}_1)-b_i^T X_i)})  \\
    = E_0(-\exp{(-a_i(1 + r_f) - a_i X_i^T \tilde{r}_1 - b_i^T X_i)}) \\
    = -\exp{(-a_i(1 + r_f))} E_0(-\exp{(-a_i X_i^T \tilde{r}_1 - b_i^T X_i)}) \\
    = -\exp{(-a_i(1 + r_f))} E_0(-\exp{(-a_i X_i^T (\tilde{r}_1 + \frac{b_i}{a_i}))})  \\
    = -\exp{(-a_i (1 + r_f))} \exp{(-a_i X_i^T (E_0(\tilde{r}_1) + \frac{b_i}{a_i})+\frac{1}{2}a_i^2 X_i^T \text{Var}(\tilde{r}_1)X_i)} \\
    = -\exp{(-a_i (1 + r_f))} \exp{(-a_i X_i^T (\mu + \frac{b_i}{a_i})+\frac{1}{2}a_i^2 X_i^T \Sigma X_i)} \\
    \end{aligned}
\end{equation}

The investors choose their optimal portfolios at time 0. 
The optimal portfolio $X_i$ is the one that maximizes the expected utility.
To find it, we differentiate the expected utility with respect to $X_i$ and 
set it to zero, to obtain the first-order condition.

We are going to do it step by step:

\begin{enumerate}
    \item Combine the Exponential Terms:
    \begin{equation}
        E_0(V(\tilde{W}_{1,i}, X_i)) = -\exp{(-a_i(1 + r_f)-a_iX_i^T(\mu + \frac{b_i}{a_i})+\frac{1}{2}a_i^2X_i^T\Sigma X_i)}
    \end{equation}
    and let $f(X_i)$ be the exponent:
    \begin{equation}
        E_0(V(\tilde{W}_{1,i}, X_i)) = -\exp{f(X_i)}
    \end{equation}
    \item Differentiate $f(X_i)$ with respect to $X_i$. We have the 
    chain rule:
    \begin{equation}
        \frac{\partial h}{\partial X_i} = \frac{\partial h}{\partial f} \frac{\partial f}{\partial X_i}
    \end{equation}
    If $h = - \exp{(f)}$, then $\frac{\partial h}{\partial f} = - \exp{(f)}$. 
    Therefore we have:
    \begin{equation}
        \frac{\partial h}{\partial X_i} = -\exp{(f)} \frac{\partial f}{\partial X_i}
    \end{equation}
    To tackle the derivative of $f(X_i)$, we use two rules. First $\frac{\partial x^T b}{\partial x} = b$ and
    $\frac{\partial x^T A x}{\partial x} = 2Ax$ if $A$ is symmetric. We have:
    \begin{equation}
        \frac{\partial f}{\partial X_i} = -a_i(\mu + \frac{b_i}{a_i}) + a_i^2 \Sigma X_i
    \end{equation}
    Combining:
    \begin{equation}
        \frac{\partial h}{\partial X_i} = -\exp{(f)} ( -a_i(\mu + \frac{b_i}{a_i}) + a_i^2 \Sigma X_i)
    \end{equation}
    \item Set the derivative to zero:
    \begin{equation}
        \begin{aligned}
            -\exp{(f)} ( -a_i(\mu + \frac{b_i}{a_i}) + a_i^2 \Sigma X_i) = 0 \\
            -a_i(\mu + \frac{b_i}{a_i}) + a_i^2 \Sigma X_i = 0
        \end{aligned}
    \end{equation}
    where the exponential term is always positive, so we can drop it.
    \item Rearrange and solve for $X_i$:
    \begin{equation}
        \begin{aligned}
            a_i^2 \Sigma X_i = a_i(\mu + \frac{b_i}{a_i}) \\
            a_i \Sigma X_i = \mu + \frac{b_i}{a_i} \\
            \Sigma X_i = \frac{1}{a_i}( \mu + \frac{b_i}{a_i}) \\
            X^*_i = \frac{1}{a_i} \Sigma^{-1}(\mu + \frac{b_i}{a_i})
        \end{aligned}
    \end{equation}
\end{enumerate}


\section{Climate Risk}