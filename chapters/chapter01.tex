\chapter{Factor Mimicking Portfolios}


\section{Risk is Innovation}

We have a vector of $K$ factors of risks $F_{t+h}$, with $h$ the 
forecast horizon. 
Investors form expectations of these factors at time $t-1$ and
adjust their expectations at time $t$ based on new information.
The change in expectations is given by:

\begin{equation}
    \tilde{F}_{t+h} = F_{t+h} - \phi
\end{equation}

where $\tilde{F}_{t+h}$ is the \textit{innovation} in the factors of risks.


\section{Innovation and Unexpected Returns}

On the other hand, we have the \textit{unexpected} returns $\tilde{R}_t$:

\begin{equation}
    \tilde{R}_t = R_t - \mu
\end{equation}

The main assumption behind factor mimicking portfolios is that the innovation 
$\tilde{F_{t+h}}$ is reflected in the unexpected returns $\tilde{R}_t$:

\begin{equation}
    \tilde{R}_t = B \tilde{F}_{t+h} + \varepsilon_t
\end{equation}
    
where $B$ is a $N \times K$ matrix of factor loadings, $\varepsilon_t$ is a $N \times 1$ vector of mean zero disturbances.

It means that investors reprice assets (unexpected returns $\tilde{R}_t$) based on the arrival of new information on the factors of risks (innovation $\tilde{F}_{t+h}$).


\section{Linear Factor Model}

If:

\begin{equation}
    R_t = \mu + \tilde{R}_t
\end{equation}

Then, substituting $\tilde{R}_t$, we have the following factor model:

\begin{equation}
    R_t = \mu + B \tilde{F}_{t+h} + \varepsilon_t
\end{equation}

with $R_t$ a $N \times 1$ vector of 
asset returns, $\mu$ a $N \times 1$ vector
of expected returns, $B$ a $N \times K$ matrix
of factor loadings, $F_{t+h}$ a $K \times 1$ vector
of factor innovations and $\varepsilon_t$ a $N \times 1$
vector of mean zero disturbances.



\section{Factor Mimicking}

The vector of weights $w_k$ 
is the solution to the following optimization problem:

\begin{equation}
    \begin{aligned}
        & \underset{w_k}{\min}
        & &  \frac{1}{2} w_k^T \Sigma w_k \\
        & \text{subject to}
        & & B^T w_k = \beta_k
    \end{aligned}
\end{equation}

where $B$ is the $N \times K$ matrix of factor loadings, $\beta_k$ is the $K \times 1$ vector of factor exposures,
with the $k$-th element equal to 1 and the other elements equal to $\beta_{k,l}$, 
and $\Sigma$ is the $N \times N$ covariance matrix of asset returns.

We can form the Lagrangian:

\begin{equation}
    \mathcal{L}(w_k, \lambda) = \frac{1}{2} w_k^T \Sigma w_k - \lambda_k^T (B^T w_k - \beta_k)
\end{equation}

where $\lambda_k$ is the $K \times 1$ vector of Lagrange multipliers.

The first order condition is:

\begin{equation}
    \begin{aligned}
        \frac{\partial \mathcal{L}}{\partial w_k} &= \Sigma w_k - B \lambda = 0 \\
        \Rightarrow w_k &= \Sigma^{-1} B \lambda_k
    \end{aligned}
\end{equation}

Substituting $w_k$ in the constraint, we have:

\begin{equation}
    \begin{aligned}
        B^T w_k &= \beta_k \\
        B^T \Sigma^{-1} B \lambda_k &= \beta_k \\
        \Rightarrow \lambda_k &= (B^T \Sigma^{-1} B)^{-1} \beta_k
    \end{aligned}
\end{equation}

Substituting $\lambda_k$ in $w_k$, we finally have 
the solution to the optimization problem:

\begin{equation}
    w_k^* = \Sigma^{-1} B (B^T \Sigma^{-1} B)^{-1} \beta_k
\end{equation}


\section{Risk Premia}

\section{Conclusion}

In what follows, we will focus 
on the case of climate risk factors.
First stage is to identify how to measure 
climate risk factors.
